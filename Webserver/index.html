<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Mecanismo Oscilante</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Mecanismo Oscilante</h1>
            <div class="connection-status" id="connectionStatus">
                <span class="status-dot"></span>
                <span class="status-text">Desconectado</span>
            </div>
        </header>

        <div class="main-grid">
            <!-- Panel de Control de Motores -->
            <div class="panel motor-panel">
                <h2>Control de Motores</h2>
                
                <!-- Motor Rotacional (Crank) -->
                <section class="motor-section">
                    <h3>Motor del Crank</h3>
                    <div class="motor-visual">
                        <div class="rotating-motor" id="rotatingMotor">
                            <div class="motor-indicator"></div>
                        </div>
                    </div>
                    
                    <div class="controls-grid">
                        <div class="control-row">
                            <label>Velocidad:</label>
                            <input type="range" id="crankSpeed" min="0" max="100" value="0" step="1">
                            <span class="value-display" id="crankSpeedValue">0 RPM</span>
                        </div>
                        
                        <div class="control-row">
                            <label>Direcci√≥n:</label>
                            <select id="crankDirection">
                                <option value="1">Horario (CW)</option>
                                <option value="-1">Antihorario (CCW)</option>
                            </select>
                            <button class="btn btn-send" id="btnSendCrank">Enviar</button>
                        </div>
                    </div>
                </section>

                <!-- Motor Lineal (Actuador) -->
                <section class="motor-section">
                    <h3>Actuador Lineal</h3>
                    <div class="motor-visual linear">
                        <div class="linear-track">
                            <div class="linear-slider" id="linearSlider"></div>
                            <div class="track-markers">
                                <span>0</span>
                                <span>7.15</span>
                                <span>14.3 cm</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="controls-grid">
                        <div class="control-row">
                            <label>Modo:</label>
                            <select id="linearMode">
                                <option value="fixed">Fijo</option>
                                <option value="oscillating">Oscilante</option>
                            </select>
                            <span class="value-display" id="modeIndicator">Fijo</span>
                        </div>

                        <!-- Controles modo Fijo -->
                        <div id="fixedControls">
                            <div class="control-row">
                                <label>Posici√≥n:</label>
                                <input type="range" id="linearPosition" min="0" max="14.3" value="0" step="0.1">
                                <span class="value-display" id="linearPosValue">0 cm</span>
                            </div>
                            <div class="control-row justify-end">
                                <button class="btn btn-send" id="btnSendPosition">Enviar Posici√≥n</button>
                            </div>
                        </div>

                        <!-- Controles modo Oscilante -->
                        <div id="oscillatingControls" class="hidden">
                            <div class="control-row">
                                <label>Rango M√≠n:</label>
                                <input type="range" id="oscMin" min="0" max="14.3" value="0" step="0.1">
                                <span class="value-display" id="oscMinValue">0 cm</span>
                            </div>
                            <div class="control-row">
                                <label>Rango M√°x:</label>
                                <input type="range" id="oscMax" min="0" max="14.3" value="14.3" step="0.1">
                                <span class="value-display" id="oscMaxValue">14.3 cm</span>
                            </div>
                            <div class="control-row">
                                <label>Velocidad:</label>
                                <input type="range" id="oscSpeed" min="0" max="15" value="5" step="0.5">
                                <span class="value-display" id="oscSpeedValue">5 cm/s</span>
                            </div>
                            <div class="control-row justify-end">
                                <button class="btn btn-send" id="btnStartOsc">Iniciar Oscilaci√≥n</button>
                                <button class="btn btn-stop" id="btnStopOsc">Detener</button>
                            </div>
                        </div>
                    </div>

                    <!-- Info del actuador -->
                    <div class="info-panel">
                        <div class="info-row">
                            <span class="info-label">Posici√≥n Actual:</span>
                            <span class="info-value" id="currentPosition">0 cm</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Estado:</span>
                            <span class="info-value" id="actuatorState">Detenido</span>
                        </div>
                    </div>
                </section>

                <!-- Botones de control general -->
                <div class="general-controls">
                    <button class="btn btn-emergency" id="btnEmergency">‚ö† PARADA EMERGENCIA</button>
                </div>
                <div class="general-controls secondary">
                    <button class="btn btn-stop-motors" id="btnStopMotors">‚èπ Detener Motores</button>
                    <button class="btn btn-reset" id="btnResetEncoders">üîÑ Reset Encoders</button>
                </div>
            </div>

            <!-- Panel de Gr√°ficas -->
            <div class="panel charts-panel">
                <h2>Visualizaci√≥n del Mecanismo</h2>
                
                <div class="chart-container">
                    <h3>Variaci√≥n de Altura (O_y)</h3>
                    <canvas id="chartOy"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3>√Ångulo de Inclinaci√≥n (Œ∏‚ÇÑ)</h3>
                    <canvas id="chartTh4"></canvas>
                </div>

                <div class="realtime-values">
                    <div class="value-card">
                        <span class="value-label">Altura O_y</span>
                        <span class="value-number" id="realtimeOy">0.00</span>
                        <span class="value-unit">cm</span>
                    </div>
                    <div class="value-card">
                        <span class="value-label">√Ångulo Œ∏‚ÇÑ</span>
                        <span class="value-number" id="realtimeTh4">0.00</span>
                        <span class="value-unit">¬∞</span>
                    </div>
                </div>

                <div class="chart-controls">
                    <button class="btn btn-secondary" id="btnClearCharts">Limpiar Gr√°ficas</button>
                    <button class="btn btn-secondary" id="btnPauseCharts">‚è∏ Pausar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="chart.umd.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
